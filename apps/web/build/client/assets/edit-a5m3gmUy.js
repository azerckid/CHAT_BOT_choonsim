import{w as N,a as v,f as k,b as A,g as C,c as E,r as g,F as y}from"./chunk-WWGJGFF6-C0NtPc5H.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{A as _}from"./AdminLayout-Buts2ej8.js";import{c as o}from"./utils-BQHNewu7.js";import{t as n}from"./index-XQpFve_7.js";import"./_commonjsHelpers-DaWZu8wl.js";import"./index-Dc7LDrXT.js";const L=N(function(){const{character:s}=v(),l=k(),d=A(),w=C(),p=E(),m=w.state!=="idle",r=!s,[x,j]=g.useState("identity");return g.useEffect(()=>{l?.success?l.deleted?(n.success(l.message||"Deleted"),d("/admin/characters")):(n.success(l.message||"Success"),r&&d("/admin/characters")):l?.error&&n.error(l.error)},[l,d,r]),e.jsx(_,{children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-3xl font-black italic tracking-tighter text-white uppercase",children:r?"Create Character":`Edit: ${s.name}`}),e.jsx("p",{className:"text-white/40 text-sm font-medium",children:"Configure identity, persona, and media."})]}),e.jsxs("div",{className:"flex gap-3",children:[!r&&e.jsxs(y,{method:"post",onSubmit:t=>{confirm("Are you sure? This will delete all conversation history for this character.")||t.preventDefault()},children:[e.jsx("input",{type:"hidden",name:"_action",value:"delete"}),e.jsx("button",{type:"submit",className:"px-6 py-3 bg-red-500/10 text-red-500 border border-red-500/20 rounded-xl font-bold text-sm hover:bg-red-500 hover:text-white transition-all",children:"DELETE"})]}),e.jsx("button",{onClick:()=>d("/admin/characters"),className:"px-6 py-3 bg-white/5 text-white/60 rounded-xl font-bold text-sm hover:text-white transition-all",children:"CANCEL"})]})]}),e.jsx("div",{className:"flex gap-2 p-1 bg-[#1A1821] rounded-2xl w-fit border border-white/5",children:["identity","ai","media"].map(t=>e.jsx("button",{onClick:()=>j(t),className:o("px-6 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-all",x===t?"bg-primary text-black shadow-lg shadow-primary/20":"text-white/40 hover:text-white"),children:t},t))}),e.jsxs(y,{method:"post",className:"space-y-8",children:[e.jsx("div",{className:o(x!=="identity"&&"hidden"),children:e.jsxs("div",{className:"bg-[#1A1821]/60 border border-white/5 rounded-[40px] p-8 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-white/40 uppercase tracking-[0.2em] ml-2",children:"Character ID (Handle)"}),e.jsx("input",{name:"id",defaultValue:s?.id,readOnly:!r,placeholder:"e.g. chunsim",className:o("w-full bg-black/40 border border-white/10 rounded-2xl px-6 py-4 text-white focus:outline-none focus:border-primary/50 transition-all font-bold",!r&&"opacity-50 cursor-not-allowed")}),r&&e.jsx("p",{className:"text-[10px] text-white/20 ml-2 italic",children:"* Use only lowercase, numbers, and underscores."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-white/40 uppercase tracking-[0.2em] ml-2",children:"Display Name"}),e.jsx("input",{name:"name",defaultValue:s?.name,placeholder:"e.g. 춘심",className:"w-full bg-black/40 border border-white/10 rounded-2xl px-6 py-4 text-white focus:outline-none focus:border-primary/50 transition-all font-bold"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-white/40 uppercase tracking-[0.2em] ml-2",children:"Role/Tag"}),e.jsx("input",{name:"role",defaultValue:s?.role,placeholder:"e.g. K-Pop Idol",className:"w-full bg-black/40 border border-white/10 rounded-2xl px-6 py-4 text-white focus:outline-none focus:border-primary/50 transition-all font-bold"})]}),e.jsx("div",{className:"flex items-end pb-4",children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",name:"isOnline",value:"true",defaultChecked:s?.isOnline,className:"sr-only peer"}),e.jsx("div",{className:"w-12 h-6 bg-white/10 rounded-full peer peer-checked:bg-primary transition-all duration-300"}),e.jsx("div",{className:"absolute left-1 top-1 w-4 h-4 bg-white rounded-full peer-checked:translate-x-6 transition-all duration-300"})]}),e.jsx("span",{className:"text-sm font-black text-white/40 group-hover:text-white transition-colors uppercase tracking-widest",children:"Online Status"})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-white/40 uppercase tracking-[0.2em] ml-2",children:"Short Bio"}),e.jsx("input",{name:"bio",defaultValue:s?.bio,placeholder:"Briefly describe the character",className:"w-full bg-black/40 border border-white/10 rounded-2xl px-6 py-4 text-white focus:outline-none focus:border-primary/50 transition-all font-bold"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-white/40 uppercase tracking-[0.2em] ml-2",children:"Greeting Message"}),e.jsx("textarea",{name:"greetingMessage",defaultValue:s?.greetingMessage||"",placeholder:"The first message the AI sends",rows:2,className:"w-full bg-black/40 border border-white/10 rounded-2xl px-6 py-4 text-white focus:outline-none focus:border-primary/50 transition-all font-medium resize-none"})]})]})}),e.jsx("div",{className:o(x!=="ai"&&"hidden"),children:e.jsx("div",{className:"bg-[#1A1821]/60 border border-white/5 rounded-[40px] p-8 space-y-6",children:e.jsxs("div",{className:"space-y-2 text-right",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2 px-2",children:[e.jsx("label",{className:"text-[10px] font-black text-white/40 uppercase tracking-[0.2em]",children:"System Persona Prompt"}),e.jsx("span",{className:"text-[10px] text-primary font-bold italic tracking-tighter px-2 py-1 bg-primary/10 rounded-lg",children:"High Precision Emotion Engine"})]}),e.jsx("textarea",{name:"personaPrompt",defaultValue:s?.personaPrompt,placeholder:"Define the core personality, speech patterns, and secrets...",className:"w-full h-[500px] bg-black/40 border border-white/10 rounded-[32px] p-8 text-white focus:outline-none focus:border-primary/50 transition-all font-mono text-sm leading-relaxed"}),e.jsx("p",{className:"text-[10px] text-white/20 italic",children:"* This prompt defines how the AI will behave. Be specific about tone and emojis."})]})})}),e.jsx("div",{className:o(x!=="media"&&"hidden"),children:e.jsx("div",{className:"space-y-12 animate-in fade-in duration-500 pb-20",children:r?e.jsxs("div",{className:"bg-[#1A1821]/60 border border-white/5 rounded-[40px] p-8 flex flex-col items-center justify-center min-h-[300px] text-center space-y-4",children:[e.jsx("span",{className:"material-symbols-outlined text-white/10 text-[64px]",children:"priority_high"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-lg font-black italic text-white/40 uppercase",children:"Action Required"}),e.jsx("p",{className:"text-sm text-white/20 font-medium",children:"Please save the character identity first before uploading media."})]})]}):e.jsx(e.Fragment,{children:[{type:"AVATAR",label:"Profile Avatar",desc:"Small icon for chats and profile identification.",icon:"account_circle"},{type:"COVER",label:"Background Cover",desc:"Large background image for home screen and highlights.",icon:"wallpaper"},{type:"NORMAL",label:"Standard Gallery",desc:"Public photos available in the character's gallery.",icon:"photo_library"},{type:"SECRET",label:"Secret Reward",desc:"Hidden images unlocked through user interaction.",icon:"lock"}].map(t=>{const b=s.media.filter(i=>i.type===t.type);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-end px-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-primary text-[20px]",children:t.icon}),e.jsx("h3",{className:"text-xl font-black italic text-white uppercase tracking-tighter",children:t.label})]}),e.jsx("p",{className:"text-white/40 text-[10px] font-medium uppercase tracking-widest",children:t.desc})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",id:`upload-${t.type}`,className:"hidden",accept:"image/*",onChange:async i=>{const c=i.target.files?.[0];if(!c)return;const a=n.loading(`Uploading ${t.label}...`);try{const h=new FormData;h.append("file",c);const f=await(await fetch("/api/upload",{method:"POST",body:h})).json();if(f.url){const u=new FormData;if(u.append("_action","add_media"),u.append("url",f.url),u.append("type",t.type),(await fetch(window.location.pathname,{method:"POST",body:u})).ok)n.success(`${t.label} added!`,{id:a}),p.revalidate();else throw new Error("Failed to save media")}}catch{n.error("Upload failed",{id:a})}}}),e.jsxs("button",{type:"button",disabled:m,onClick:()=>document.getElementById(`upload-${t.type}`)?.click(),className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-white text-[10px] font-black uppercase tracking-widest hover:bg-white/10 hover:border-primary/50 hover:text-primary transition-all flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"add_a_photo"}),"Upload New"]})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4",children:b.length===0?e.jsxs("div",{className:"col-span-full py-12 bg-black/20 border border-dashed border-white/5 rounded-[32px] flex flex-col items-center justify-center text-center space-y-2 opacity-40",children:[e.jsx("span",{className:"material-symbols-outlined text-[32px]",children:"no_photography"}),e.jsxs("p",{className:"text-[10px] font-bold uppercase tracking-widest",children:["No ",t.label," uploaded"]})]}):b.map((i,c)=>e.jsxs("div",{className:"group relative bg-black/40 border border-white/5 rounded-3xl overflow-hidden aspect-square",children:[e.jsx("img",{src:i.url,alt:t.label,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"}),e.jsxs("div",{className:"absolute inset-0 bg-black/80 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center space-y-3 p-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:async()=>{const a=new FormData;a.append("_action","reorder_media"),a.append("mediaId",i.id),a.append("direction","up"),await fetch(window.location.pathname,{method:"POST",body:a}),p.revalidate()},className:"w-8 h-8 rounded-lg bg-white/10 text-white flex items-center justify-center hover:bg-primary hover:text-black transition-all",children:e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"arrow_back"})}),e.jsx("button",{type:"button",onClick:async()=>{const a=new FormData;a.append("_action","reorder_media"),a.append("mediaId",i.id),a.append("direction","down"),await fetch(window.location.pathname,{method:"POST",body:a}),p.revalidate()},className:"w-8 h-8 rounded-lg bg-white/10 text-white flex items-center justify-center hover:bg-primary hover:text-black transition-all",children:e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"arrow_forward"})})]}),e.jsx("button",{type:"button",onClick:async()=>{if(!confirm("Are you sure?"))return;const a=new FormData;a.append("_action","delete_media"),a.append("mediaId",i.id),(await fetch(window.location.pathname,{method:"POST",body:a})).ok&&(n.success("Media deleted"),p.revalidate())},className:"w-8 h-8 rounded-lg bg-red-500/20 text-red-500 border border-red-500/40 flex items-center justify-center hover:bg-red-500 hover:text-white transition-all",children:e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"delete"})})]}),e.jsx("div",{className:"absolute top-2 left-2 px-2 py-0.5 rounded-lg bg-black/60 backdrop-blur-md text-[8px] font-black text-white/60 uppercase tracking-tighter",children:c===0?"★ Main":`#${c+1}`})]},i.id))})]},t.type)})})})}),e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx("button",{type:"submit",disabled:m,className:o("w-full py-6 bg-primary text-[#0B0A10] rounded-[32px] font-black italic text-xl tracking-tighter transition-all hover:scale-[1.02] active:scale-95 shadow-[0_10px_40px_rgba(255,0,255,0.4)] flex items-center justify-center gap-3",m&&"opacity-50 cursor-not-allowed"),children:m?e.jsx("span",{className:"w-6 h-6 border-4 border-black border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-symbols-outlined font-bold",children:"bolt"}),r?"DEBUT CHARACTER":"SAVE CORE SETTINGS"]})})})]})]})})});export{L as default};
